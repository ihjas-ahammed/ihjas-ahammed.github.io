<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic Literature Learner</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap');

        :root {
            --primary: #58CC02;
            --primary-hover: #4CAF50;
            --wrong: #FF4B4B;
            --correct: #58CC02;
            --neutral: #E5E5E5;
            --text: #4B4B4B;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Nunito', sans-serif;
        }

        body {
            background: #f7f7f7;
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .nav-btn {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .nav-btn:disabled {
            background: var(--neutral);
            cursor: not-allowed;
        }

        .nav-btn:not(:disabled):hover {
            background: var(--primary-hover);
        }

        .menu-btn {
            padding: 10px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 10px;
        }

        .progress-bar {
            height: 12px;
            background: var(--neutral);
            border-radius: 6px;
            overflow: hidden;
            flex-grow: 1;
            margin: 0 20px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        .lives {
            display: flex;
            gap: 5px;
        }

        .heart {
            color: var(--wrong);
            font-size: 24px;
        }

        .level-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .level-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .level-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: var(--primary);
            border-radius: 0 0 12px 12px;
            transition: width 0.3s ease;
        }

        .question-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            padding: 15px;
            border: 2px solid var(--neutral);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
        }

        .option:hover {
            background: #f0f0f0;
        }

        .option.correct {
            background: var(--correct);
            color: white;
            border-color: var(--correct);
        }

        .option.wrong {
            background: var(--wrong);
            color: white;
            border-color: var(--wrong);
        }
    </style>
</head>

<body>
    <div class="header">
        <button class="menu-btn" onclick="returnToMainMenu()">Menu</button>
        <div class="lives">
            <span class="heart">‚ù§Ô∏è</span>
            <span class="heart">‚ù§Ô∏è</span>
            <span class="heart">‚ù§Ô∏è</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        <div class="score">0</div>
    </div>

    <div class="container">
        <div class="level-select">
            <!-- Level cards will be generated dynamically -->
        </div>

        <div id="question-container" class="question-container" style="display: none;">
            <div class="question"></div>
            <div class="options"></div>
            <div class="feedback"></div>
            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn" onclick="previousQuestion()">Previous</button>
                <button class="nav-btn" id="nextBtn" onclick="nextQuestion()">Next</button>
                <button class="nav-btn" onclick="restartLevel()">Restart Level</button>
            </div>
        </div>
    </div>

    <script>
        const levels = {
            1: [
                {
                    type: 'basic',
                    question: 'Who is Taha Hussein?',
                    options: [
                        'A modern poet',
                        'A prominent Egyptian writer and intellectual',
                        'A political leader',
                        'A religious scholar'
                    ],
                    correct: 1,
                    explanation: 'Taha Hussein (1889-1973) was a prominent Egyptian writer, intellectual, and literary critic.'
                },
                {
                    type: 'basic',
                    question: 'What is "The Days" (ÿßŸÑÿ£ŸäÿßŸÖ)?',
                    options: [
                        'A collection of poems',
                        'An autobiography',
                        'A political manifesto',
                        'A religious text'
                    ],
                    correct: 1,
                    explanation: '"The Days" is Taha Hussein\'s autobiography and one of his most famous works.'
                },
                {
                    type: 'basic',
                    question: 'What is the main topic of this excerpt?',
                    options: [
                        'A father\'s love for his daughter',
                        'The importance of education',
                        'The beauty of nature',
                        'The struggles of life'
                    ],
                    correct: 0,
                    explanation: 'The excerpt focuses on the deep affection and protective instincts of a father towards his daughter.'
                },
                {
                    type: 'basic',
                    question: 'How old is the daughter in the text?',
                    options: ['5', '9', '12', '15'],
                    correct: 1,
                    explanation: 'The text states that the daughter is in the ninth year of her life (ŸÅŸä ÿßŸÑÿ™ÿßÿ≥ÿπÿ© ŸÖŸÜ ÿπŸÖÿ±ŸÉ).'
                },
                {
                    type: 'basic',
                    question: 'What is the significance of Taha Hussein in Arabic literature?',
                    options: [
                        'He introduced new poetic forms.',
                        'He wrote the first Arabic novel.',
                        'He was a leading figure in the Arab Renaissance.',
                        'He translated many Western works into Arabic.'
                    ],
                    correct: 2,
                    explanation: 'Taha Hussein was a key figure in the Nahda (Arab Renaissance), contributing to the modernization of Arabic literature.'
                },
                {
                    type: 'basic',
                    question: 'What personal challenge did Taha Hussein face?',
                    options: [
                        'He grew up in poverty.',
                        'He lost his sight at a young age.',
                        'He was exiled from his country.',
                        'He was imprisoned for his beliefs.'
                    ],
                    correct: 1,
                    explanation: 'Taha Hussein lost his sight as a child, a fact that often influenced his writing.'
                },
                {
                    type: 'basic',
                    question: 'What is the general tone of the excerpt?',
                    options: [
                        'Angry and critical',
                        'Sad and mournful',
                        'Loving and protective',
                        'Humorous and lighthearted'
                    ],
                    correct: 2,
                    explanation: 'The father expresses deep affection and a desire to protect his daughter, creating a loving and protective tone.'
                },
                {
                    type: 'basic',
                    question: 'What does the father want to protect his daughter from?',
                    options: [
                        'Bad influences',
                        'The hardships of life',
                        'Academic pressure',
                        'Social expectations'
                    ],
                    correct: 1,
                    explanation: 'The father aims to shield his daughter from the difficulties and sorrows he experienced in his own life.'
                },
                {
                    type: 'basic',
                    question: 'What does the father believe about children at his daughter\'s age?',
                    options: [
                        'They are easily influenced by their peers.',
                        'They idolize their parents.',
                        'They are naturally rebellious.',
                        'They are eager to learn about the world.'
                    ],
                    correct: 1,
                    explanation: 'The text suggests that children at this age often see their parents as role models and want to be like them.'
                },
                {
                    type: 'basic',
                    question: 'What does the father imply about his own childhood?',
                    options: [
                        'It was filled with joy and happiness.',
                        'It was marked by challenges and hardships.',
                        'It was ordinary and uneventful.',
                        'It was spent traveling the world.'
                    ],
                    correct: 1,
                    explanation: 'The father hints that his childhood was difficult, and he wants to prevent his daughter from experiencing the same.'
                }
            ],
            2: [
                {
                    type: 'vocabulary',
                    question: 'What does ÿ≥Ÿéÿßÿ∞Ÿêÿ¨Ÿéÿ© mean?',
                    options: ['Pure', 'Naive', 'Kind', 'Best'],
                    correct: 1,
                    explanation: 'ÿ≥Ÿéÿßÿ∞Ÿêÿ¨Ÿéÿ© (saadhijah) means naive or innocent in Arabic.'
                },
                {
                    type: 'vocabulary',
                    arabic: 'ÿ∑ŸéŸäŸêŸëÿ®ÿ© ÿßŸÑŸÜŸÅÿ≥',
                    question: 'Translate this phrase:',
                    options: ['Pure heart', 'Kind soul', 'Strong mind', 'Great wisdom'],
                    correct: 1,
                    explanation: 'ÿ∑ŸéŸäŸêŸëÿ®ÿ© ÿßŸÑŸÜŸÅÿ≥ means "kind-souled" or "of kind soul".'
                },
                {
                    type: 'vocabulary',
                    question: 'What does  ŸäŸèŸÅÿßÿÆÿ±ŸàŸÜ  mean?',
                    options: ['To admire', 'To boast', 'To convince', 'To protect'],
                    correct: 1,
                    explanation: 'ŸäŸèŸÅÿßÿÆÿ±ŸàŸÜ (yufaakhiroon) means to boast or take pride in something.'
                },
                {
                    type: 'vocabulary',
                    arabic: 'ÿ£ŸÇÿ±ÿßŸÜŸáŸÖ',
                    question: 'Translate this word:',
                    options: ['Parents', 'Peers', 'Teachers', 'Siblings'],
                    correct: 1,
                    explanation: 'ÿ£ŸÇÿ±ÿßŸÜŸáŸÖ (aqraanuhum) means "their peers".'
                },
                {
                    type: 'vocabulary',
                    question: 'What does  Ÿäÿ®ÿ∞ŸÑ  mean?',
                    options: ['To give', 'To take', 'To hide', 'To forget'],
                    correct: 0,
                    explanation: 'Ÿäÿ®ÿ∞ŸÑ (yabdhulu) means to exert, give, or expend effort.'
                },
                {
                    type: 'vocabulary',
                    arabic: 'ÿßŸÑŸÖÿ¥ŸÇÿ©',
                    question: 'What does this word mean?',
                    options: ['Happiness', 'Hardship', 'Effort', 'Childhood'],
                    correct: 1,
                    explanation: 'ÿßŸÑŸÖÿ¥ŸÇÿ© (al-mashaqah) means hardship or difficulty.'
                },
                {
                    type: 'vocabulary',
                    question: 'What does  Ÿäÿ∑ŸäŸÇ  mean?',
                    options: ['To endure', 'To play', 'To learn', 'To grow'],
                    correct: 0,
                    explanation: 'Ÿäÿ∑ŸäŸÇ (yateegu) means to be able to bear or endure something.'
                },
                {
                    type: 'vocabulary',
                    arabic: 'ŸÑŸäÿ¨ŸÜÿ®ŸÉ',
                    question: 'Translate this word:',
                    options: ['To help you', 'To teach you', 'To spare you from', 'To give you'],
                    correct: 2,
                    explanation: 'ŸÑŸäÿ¨ŸÜÿ®ŸÉ (lijanibak) means "to spare you from" something.'
                },
                {
                    type: 'vocabulary',
                    question: 'What does  ÿµÿ®Ÿäÿß  mean?',
                    options: ['A young boy', 'A young girl', 'A father', 'A teacher'],
                    correct: 0,
                    explanation: 'ÿµÿ®Ÿäÿß (sabyaa) means a young boy.'
                },
                {
                    type: 'vocabulary',
                    arabic: 'ŸÇÿØŸàÿ© ÿ≠ÿ≥ŸÜÿ©',
                    question: 'Translate this phrase:',
                    options: ['Good example', 'Kind heart', 'Strong will', 'Happy life'],
                    correct: 0,
                    explanation: 'ŸÇÿØŸàÿ© ÿ≠ÿ≥ŸÜÿ© (qidwah hasanah) means "good example" or "role model".'
                }
            ],
            3: [
                {
                    type: 'theme',
                    question: 'What is one of the main themes in "To My Daughter"?',
                    options: [
                        'A father\'s protective love',
                        'Political commentary',
                        'Historical events',
                        'Scientific discoveries'
                    ],
                    correct: 0,
                    explanation: 'The text strongly emphasizes the father\'s protective love and desire to shield his daughter from hardships.'
                },
                {
                    type: 'theme',
                    question: 'How does the father view his daughter?',
                    options: [
                        'As naive and pure-hearted',
                        'As rebellious and difficult',
                        'As mature and worldly',
                        'As talented and ambitious'
                    ],
                    correct: 0,
                    explanation: 'The father sees his daughter as innocent and pure-hearted, wanting to protect her innocence.'
                },
                {
                    type: 'theme',
                    question: 'Which statement best describes the father\'s feelings about the passage of time?',
                    options: [
                        'He embraces aging and the wisdom it brings.',
                        'He fears the future and the uncertainties it holds.',
                        'He is nostalgic for his own childhood.',
                        'He wants to slow down time to savor his daughter\'s youth.'
                    ],
                    correct: 3,
                    explanation: 'The father reflects on his own past and expresses a desire to preserve his daughter\'s innocence, suggesting a wish to slow down time.'
                },
                {
                    type: 'theme',
                    question: 'What is the significance of the father\'s reflection on his own childhood?',
                    options: [
                        'To show how much he has changed',
                        'To emphasize the universality of childhood experiences',
                        'To contrast his experiences with his daughter\'s',
                        'To express regret for his past mistakes'
                    ],
                    correct: 2,
                    explanation: 'By reflecting on his own past, the father highlights the difference between his difficult childhood and the innocent world he wants for his daughter.'
                },
                {
                    type: 'theme',
                    question: 'What is the father\'s attitude towards his daughter\'s idealized view of him?',
                    options: [
                        'He is amused by it.',
                        'He is uncomfortable with it.',
                        'He encourages it.',
                        'He is indifferent to it.'
                    ],
                    correct: 0,
                    explanation: 'While the father appreciates his daughter\'s admiration, he also recognizes that it is based on a limited understanding of him and the world.'
                },
                {
                    type: 'theme',
                    question: 'How does the text portray the innocence of childhood?',
                    options: [
                        'As something to be cherished and protected',
                        'As a phase to be quickly outgrown',
                        'As a source of ignorance and naivety',
                        'As a time of carefree play and exploration'
                    ],
                    correct: 0,
                    explanation: 'The father clearly values his daughter\'s innocence and wants to shield her from the harsh realities of the world.'
                },
                {
                    type: 'theme',
                    question: 'What is the role of hardship in the text?',
                    options: [
                        'It is seen as a necessary part of life.',
                        'It is something to be avoided at all costs.',
                        'It is a source of strength and resilience.',
                        'It is a test of faith and character.'
                    ],
                    correct: 1,
                    explanation: 'The father\'s primary goal is to protect his daughter from the hardships he experienced, suggesting a desire to prevent suffering.'
                },
                {
                    type: 'theme',
                    question: 'How does the father\'s perspective as a writer influence the text?',
                    options: [
                        'He uses vivid imagery and metaphors.',
                        'He focuses on factual details and events.',
                        'He employs a formal and academic tone.',
                        'He incorporates elements of fantasy and fiction.'
                    ],
                    correct: 0,
                    explanation: 'As a writer, Taha Hussein uses evocative language and imagery to convey his emotions and create a powerful impact on the reader.'
                },
                {
                    type: 'theme',
                    question: 'What is the significance of the title "To My Daughter"?',
                    options: [
                        'It highlights the personal and intimate nature of the text.',
                        'It suggests that the text is intended as a guide for all young girls.',
                        'It indicates that the text is a fictional story.',
                        'It implies that the text is a formal letter of instruction.'
                    ],
                    correct: 0,
                    explanation: 'The title emphasizes the direct address to the daughter, creating a sense of personal connection and intimacy.'
                },
                {
                    type: 'theme',
                    question: 'What is the overall message of the excerpt?',
                    options: [
                        'Life is full of challenges that must be overcome.',
                        'Parents should always strive to protect their children.',
                        'Childhood innocence is precious and fleeting.',
                        'Education is the key to a successful future.'
                    ],
                    correct: 2,
                    explanation: 'The excerpt conveys the idea that childhood innocence is valuable and should be cherished, as it is temporary and easily lost.'
                }
            ],
            4: [
                {
                    type: 'analysis',
                    question: 'What literary device does Hussein use when asking rhetorical questions?',
                    options: [
                        'To show his daughter\'s perspective',
                        'To emphasize the father-daughter relationship',
                        'To create dramatic tension',
                        'To critique society'
                    ],
                    correct: 1,
                    explanation: 'The rhetorical questions serve to highlight the close bond between father and daughter.'
                },
                {
                    type: 'analysis',
                    question: 'What is the effect of the rhetorical questions used in the text?',
                    options: [
                        'They create a sense of doubt and uncertainty.',
                        'They challenge the reader to question their own beliefs.',
                        'They engage the reader and emphasize the father\'s point.',
                        'They introduce different perspectives on the topic.'
                    ],
                    correct: 2,
                    explanation: 'The rhetorical questions draw the reader in and reinforce the father\'s assertions about his daughter\'s perception of him.'
                },
                {
                    type: 'analysis',
                    question: 'How does the author\'s use of language contribute to the tone of the excerpt?',
                    options: [
                        'The use of formal language creates a distant and authoritative tone.',
                        'The use of simple language makes the text accessible to a young audience.',
                        'The use of poetic language evokes a sense of love and tenderness.',
                        'The use of humorous language creates a lighthearted and playful atmosphere.'
                    ],
                    correct: 2,
                    explanation: 'Taha Hussein employs elegant and expressive language that contributes to the loving and protective tone of the passage.'
                },
                {
                    type: 'analysis',
                    question: 'What is the purpose of the father\'s detailed description of his daughter\'s innocence?',
                    options: [
                        'To provide a realistic portrayal of childhood',
                        'To contrast her innocence with the harshness of the world',
                        'To foreshadow her future development',
                        'To criticize societal expectations of children'
                    ],
                    correct: 1,
                    explanation: 'By emphasizing his daughter\'s innocence, the father implicitly contrasts it with the difficulties and complexities of the adult world.'
                },
                {
                    type: 'analysis',
                    question: 'How does the father\'s use of imagery enhance the text?',
                    options: [
                        'It creates a vivid picture of the daughter\'s physical appearance.',
                        'It evokes a sense of the father\'s emotional state.',
                        'It provides a detailed description of the setting.',
                        'It symbolizes the complexities of the father-daughter relationship.'
                    ],
                    correct: 1,
                    explanation: 'While not explicitly visual due to the author\'s blindness, the imagery conveys the father\'s feelings and the emotional atmosphere of the text.'
                },
                {
                    type: 'analysis',
                    question: 'What is the significance of the line "ŸÑŸäÿ¨ŸÜÿ®ŸÉ ÿ≠Ÿäÿßÿ™Ÿá ÿ≠ŸäŸÜ ŸÉÿßŸÜ ÿµÿ®Ÿäÿß"?',
                    options: [
                        'It shows the father\'s regret for his past actions.',
                        'It highlights the father\'s determination to protect his daughter.',
                        'It suggests that the father is envious of his daughter\'s innocence.',
                        'It implies that the father wants his daughter to experience hardship.'
                    ],
                    correct: 1,
                    explanation: 'This line emphasizes the father\'s active efforts to shield his daughter from the kind of suffering he endured as a child.'
                },
                {
                    type: 'analysis',
                    question: 'What is the effect of the repetition of "ÿ£ŸÑÿ≥ÿ™" in the second paragraph?',
                    options: [
                        'It creates a sense of rhythm and flow.',
                        'It emphasizes the father\'s questioning tone.',
                        'It reinforces the father\'s assumptions about his daughter\'s beliefs.',
                        'It highlights the daughter\'s uncertainty and confusion.'
                    ],
                    correct: 2,
                    explanation: 'The repetition of "ÿ£ŸÑÿ≥ÿ™" (aren\'t you) strengthens the father\'s rhetorical questions and their impact on the reader.'
                },
                {
                    type: 'analysis',
                    question: 'How does the author create a sense of intimacy in the text?',
                    options: [
                        'By addressing the daughter directly',
                        'By using complex metaphors and similes',
                        'By focusing on universal themes',
                        'By providing historical context'
                    ],
                    correct: 0,
                    explanation: 'The direct address to the daughter ("Ÿäÿß ÿßÿ®ŸÜÿ™Ÿä" - "Oh my daughter") establishes a personal and intimate tone throughout the passage.'
                },
                {
                    type: 'analysis',
                    question: 'It introduces a new theme that will be explored later.',
                    options: [
                        'It creates a sense of closure and finality.',
                        'It calls the reader to action.',
                        'It leaves the reader with a lingering question.'
                    ],
                    correct: 0,
                    explanation: 'The last sentence provides a sense of finality to the excerpt, concluding the father\'s initial thoughts and feelings.'
                },
                {
                    type: 'analysis',
                    question: 'How does the excerpt reflect Taha Hussein\'s own life experiences?',
                    options: [
                        'The father\'s protective instincts may stem from Hussein\'s own challenges with vision loss.',
                        'The setting of the story is based on Hussein\'s childhood village.',
                        'The characters in the story are based on Hussein\'s family members.',
                        'The excerpt explores the themes of education and social reform that Hussein advocated for.'
                    ],
                    correct: 0,
                    explanation: 'Hussein\'s own experiences with disability and overcoming adversity likely influenced his desire to protect his daughter from hardship.'
                },
                {
                    type: 'analysis',
                    question: 'What is the significance of the phrase "ŸàŸÜŸÅÿ≥ŸÉ ÿßŸÑÿ≠ŸÑŸàÿ©" used to describe the daughter?',
                    options: [
                        'It emphasizes her physical beauty.',
                        'It highlights her kind and gentle nature.',
                        'It suggests her innocence and purity.',
                        'It foreshadows her future happiness.'
                    ],
                    correct: 2,
                    explanation: '"ŸàŸÜŸÅÿ≥ŸÉ ÿßŸÑÿ≠ŸÑŸàÿ©" ("your sweet soul") reinforces the idea of the daughter\'s inner goodness and innocence.'
                }]
        }
        let currentLevel = 1;
        let currentQuestion = 0;
        let score = 0;
        let lives = 3;
        let progress = 0;
        let answeredQuestions = new Set();

        // Load progress from localStorage
        function loadProgress() {
            const savedProgress = localStorage.getItem('arabicLiteratureProgress');
            if (savedProgress) {
                return JSON.parse(savedProgress);
            }
            return {
                levelProgress: {},
                totalScore: 0
            };
        }

        // Save progress to localStorage
        function saveProgress() {
            const progressData = {
                levelProgress: {},
                totalScore: score
            };

            Object.keys(levels).forEach(level => {
                progressData.levelProgress[level] = {
                    completed: answeredQuestions.size === levels[level].length,
                    progress: (answeredQuestions.size / levels[level].length) * 100
                };
            });

            localStorage.setItem('arabicLiteratureProgress', JSON.stringify(progressData));
        }

        // Initialize level select screen
        function initializeLevelSelect() {
            const levelSelect = document.querySelector('.level-select');
            const progress = loadProgress();

            levelSelect.innerHTML = Object.keys(levels).map(level => `
                <div class="level-card" onclick="startLevel(${level})">
                    <div class="level-icon">üìö</div>
                    <h3>Level ${level}</h3>
                    <p>${getLevelDescription(level)}</p>
                    <div class="level-progress" style="width: ${progress.levelProgress[level]?.progress || 0}%"></div>
                </div>
            `).join('');
        }

        function getLevelDescription(level) {
            const descriptions = {
                1: "Introduction to Taha Hussein",
                2: "Arabic Vocabulary",
                3: "Literary Themes",
                4: "Advanced Analysis"
            };
            return descriptions[level] || `Level ${level}`;
        }

        function startLevel(level) {
            currentLevel = level;
            currentQuestion = 0;
            answeredQuestions.clear();
            document.querySelector('.level-select').style.display = 'none';
            document.getElementById('question-container').style.display = 'block';
            updateNavButtons();
            showQuestion();
        }

        function showQuestion() {
            const question = levels[currentLevel][currentQuestion];
            const questionContainer = document.querySelector('.question');
            const optionsContainer = document.querySelector('.options');

            questionContainer.innerHTML = question.arabic ?
                `<div class="arabic-text">${question.arabic}</div>${question.question}` :
                question.question;

            optionsContainer.innerHTML = question.options
                .map((option, index) => `
                    <div class="option ${answeredQuestions.has(currentQuestion) ?
                        (index === question.correct ? 'correct' : '') : ''}" 
                        onclick="checkAnswer(${index})">
                        ${option}
                    </div>
                `).join('');

            updateNavButtons();
        }

        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            prevBtn.disabled = currentQuestion === 0;
            nextBtn.disabled = currentQuestion === levels[currentLevel].length - 1 &&
                answeredQuestions.has(currentQuestion);
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestion < levels[currentLevel].length - 1) {
                currentQuestion++;
                showQuestion();
            }
        }

        function checkAnswer(selectedIndex) {
            if (answeredQuestions.has(currentQuestion)) return;

            const question = levels[currentLevel][currentQuestion];
            const options = document.querySelectorAll('.option');

            if (selectedIndex === question.correct) {
                options[selectedIndex].classList.add('correct');
                score += 10;
                progress = ((answeredQuestions.size + 1) / levels[currentLevel].length) * 100;
            } else {
                options[selectedIndex].classList.add('wrong');
                options[question.correct].classList.add('correct');
                lives--;
                updateLives();
            }

            answeredQuestions.add(currentQuestion);
            document.querySelector('.score').textContent = score;
            document.querySelector('.progress-fill').style.width = `${progress}%`;
            saveProgress();
            updateNavButtons();
        }

        function updateLives() {
            const heartsContainer = document.querySelector('.lives');
            heartsContainer.innerHTML = '‚ù§Ô∏è'.repeat(lives);

            if (lives === 0) {
                gameOver();
            }
        }

        function restartLevel() {
            if (confirm('Are you sure you want to restart this level? Your progress will be reset.')) {
                startLevel(currentLevel);
                lives = 3;
                score = Math.max(0, score - 50); // Penalty for restarting
                updateLives();
                document.querySelector('.score').textContent = score;
                saveProgress();
            }
        }

        function returnToMainMenu() {
            document.querySelector('.level-select').style.display = 'grid';
            document.getElementById('question-container').style.display = 'none';
            initializeLevelSelect();
        }

        function gameOver() {
            const container = document.querySelector('.container');
            container.innerHTML = `
                <div class="question-container">
                    <div class="question">
                        <h2>Game Over!</h2>
                        <p>Final Score: ${score}</p>
                        <div class="nav-buttons">
                            <button class="nav-btn" onclick="restartLevel()">Try Again</button>
                            <button class="nav-btn" onclick="returnToMainMenu()">Main Menu</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize the game
        initializeLevelSelect();
    </script>
</body>

</html>