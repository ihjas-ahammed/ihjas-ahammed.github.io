<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Semiconductor Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation;
        }

        body {
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #111;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        #game-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #052436, #0a0a2e);
        }

        #controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-around;
            z-index: 10;
        }

        .control-btn {
            width: 80px;
            height: 80px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            user-select: none;
        }

        #left-btn::after {
            content: "←";
        }

        #right-btn::after {
            content: "→";
        }

        #jump-btn::after {
            content: "↑";
        }

        #stats {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 18px;
            z-index: 10;
        }

        #question-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            color: white;
            width: 90%;
            max-width: 500px;
            z-index: 20;
            display: none;
        }

        #question-text {
            font-size: 18px;
            margin-bottom: 15px;
        }

        .answer-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            text-align: left;
        }

        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 10px;
            color: white;
            width: 90%;
            max-width: 400px;
            z-index: 30;
            text-align: center;
            display: none;
        }

        #game-over h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        #play-again {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }

        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 40;
            color: white;
        }

        #start-screen h1 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #4fc3f7;
        }

        #start-screen p {
            width: 80%;
            text-align: center;
            margin-bottom: 30px;
            font-size: 18px;
        }

        #start-btn {
            padding: 15px 40px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>

        <div id="stats">
            Score: <span id="score">0</span> | Lives: <span id="lives">3</span>
        </div>

        <div id="controls">
            <div id="left-btn" class="control-btn"></div>
            <div id="jump-btn" class="control-btn"></div>
            <div id="right-btn" class="control-btn"></div>
        </div>

        <div id="question-container">
            <div id="question-text"></div>
            <button class="answer-btn" data-index="0"></button>
            <button class="answer-btn" data-index="1"></button>
            <button class="answer-btn" data-index="2"></button>
            <button class="answer-btn" data-index="3"></button>
        </div>

        <div id="game-over">
            <h2>Game Over</h2>
            <p>Your Score: <span id="final-score">0</span></p>
            <p>Accuracy: <span id="accuracy">0</span>%</p>
            <button id="play-again">Play Again</button>
        </div>

        <div id="start-screen">
            <h1>Semiconductor Adventure</h1>
            <p>Jump between platforms, collect electrons, and answer questions about semiconductors!</p>
            <p>Use the left and right buttons to move, and the up button to jump.</p>
            <button id="start-btn">Start Game</button>
        </div>
    </div>

    <script>
        // Game setup
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');

        // Set canvas to full window size
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Game variables
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 150,
            width: 30,
            height: 50,
            speed: 5,
            velY: 0,
            jumping: false,
            grounded: false,
            color: '#4fc3f7'
        };

        const game = {
            score: 0,
            lives: 3,
            gravity: 0.5,
            platforms: [],
            electrons: [],
            questions: [],
            correctAnswers: 0,
            totalAnswers: 0,
            gameOver: false,
            paused: false
        };

        // Control variables
        const keys = {
            left: false,
            right: false,
            up: false
        };

        // Questions about semiconductors
        game.questions = [
            {
                question: "What is a semiconductor?",
                answers: [
                    "A material with conductivity between a conductor and an insulator",
                    "A type of insulator only",
                    "A type of conductor only",
                    "A material used only in batteries"
                ],
                correct: 0
            },
            {
                question: "What is the resistivity of germanium?",
                answers: [
                    "0.6 Ω m",
                    "1.7 × 10⁻⁸ Ω m",
                    "10¹⁰ Ω m",
                    "10⁻⁶ Ω m"
                ],
                correct: 0
            },
            {
                question: "How does temperature affect a semiconductor's resistance?",
                answers: [
                    "Resistance decreases as temperature increases",
                    "Resistance increases as temperature increases",
                    "Temperature has no effect on resistance",
                    "Resistance is unrelated to temperature"
                ],
                correct: 0
            },
            {
                question: "What type of bonds are formed in semiconductors?",
                answers: [
                    "Covalent bonds",
                    "Ionic bonds",
                    "Metallic bonds",
                    "Hydrogen bonds"
                ],
                correct: 0
            },
            {
                question: "How many valence electrons does a germanium atom have?",
                answers: [
                    "4",
                    "2",
                    "8",
                    "32"
                ],
                correct: 0
            },
            {
                question: "What happens when a suitable metallic impurity is added to a semiconductor?",
                answers: [
                    "Its current conducting properties change appreciably",
                    "It becomes a perfect insulator",
                    "It transforms into a superconductor",
                    "Its resistance becomes zero"
                ],
                correct: 0
            },
            {
                question: "What is the atomic number of silicon?",
                answers: [
                    "14",
                    "32",
                    "28",
                    "16"
                ],
                correct: 0
            },
            {
                question: "What structure do semiconductors have?",
                answers: [
                    "Crystalline structure",
                    "Amorphous structure",
                    "Liquid structure",
                    "Gaseous structure"
                ],
                correct: 0
            },
            {
                question: "What is the band gap energy for silicon?",
                answers: [
                    "About 1.1 eV",
                    "About 0.7 eV",
                    "About 2.2 eV",
                    "About 0.1 eV"
                ],
                correct: 0
            },
            {
                question: "Which of these is NOT a commonly used semiconductor?",
                answers: [
                    "Nichrome",
                    "Germanium",
                    "Silicon",
                    "Both germanium and silicon are commonly used"
                ],
                correct: 0
            }
        ];

        // Initialize platforms
        function initPlatforms() {
            game.platforms = [];

            // Base platform
            game.platforms.push({
                x: 0,
                y: canvas.height - 100,
                width: canvas.width,
                height: 20,
                color: '#4CAF50'
            });

            // Generate random platforms
            const numPlatforms = 10;
            const platformHeight = 20;
            const minWidth = 100;
            const maxWidth = 200;
            const minGap = 60;
            const maxGap = 200;

            let lastPlatformY = canvas.height - 200;

            for (let i = 0; i < numPlatforms; i++) {
                const width = Math.random() * (maxWidth - minWidth) + minWidth;
                const x = Math.random() * (canvas.width - width);
                const gap = Math.random() * (maxGap - minGap) + minGap;
                lastPlatformY -= gap;

                game.platforms.push({
                    x: x,
                    y: lastPlatformY,
                    width: width,
                    height: platformHeight,
                    color: '#3F51B5'
                });

                // Add electron on some platforms
                if (Math.random() > 0.3) {
                    game.electrons.push({
                        x: x + width / 2,
                        y: lastPlatformY - 20,
                        radius: 10,
                        collected: false,
                        type: Math.random() > 0.3 ? 'normal' : 'special', // Special electrons trigger questions
                        color: Math.random() > 0.3 ? '#FFD700' : '#FF4081'
                    });
                }
            }
        }

        // Initialize game
        function initGame() {
            player.x = canvas.width / 2;
            player.y = canvas.height - 150;
            player.velY = 0;
            player.jumping = false;
            player.grounded = false;

            game.score = 0;
            game.lives = 3;
            game.electrons = [];
            game.correctAnswers = 0;
            game.totalAnswers = 0;
            game.gameOver = false;
            game.paused = false;

            document.getElementById('score').textContent = game.score;
            document.getElementById('lives').textContent = game.lives;

            initPlatforms();
        }

        // Draw functions
        function drawPlayer() {
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // Draw a simple face
            ctx.fillStyle = '#333';
            ctx.fillRect(player.x + 7, player.y + 10, 5, 5); // Left eye
            ctx.fillRect(player.x + 18, player.y + 10, 5, 5); // Right eye
            ctx.fillRect(player.x + 10, player.y + 25, 10, 3); // Mouth
        }

        function drawPlatforms() {
            game.platforms.forEach(platform => {
                ctx.fillStyle = platform.color;
                ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
            });
        }

        function drawElectrons() {
            game.electrons.forEach(electron => {
                if (!electron.collected) {
                    ctx.beginPath();
                    ctx.arc(electron.x, electron.y, electron.radius, 0, Math.PI * 2);
                    ctx.fillStyle = electron.type === 'normal' ? '#FFD700' : '#FF4081';
                    ctx.fill();
                    ctx.closePath();

                    // Add glow effect
                    ctx.beginPath();
                    ctx.arc(electron.x, electron.y, electron.radius + 5, 0, Math.PI * 2);
                    const gradient = ctx.createRadialGradient(
                        electron.x, electron.y, electron.radius,
                        electron.x, electron.y, electron.radius + 5
                    );
                    gradient.addColorStop(0, electron.type === 'normal' ? 'rgba(255, 215, 0, 0.6)' : 'rgba(255, 64, 129, 0.6)');
                    gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
                    ctx.fillStyle = gradient;
                    ctx.fill();
                    ctx.closePath();
                }
            });
        }

        function drawBackground() {
            // Draw some background elements to represent an atomic structure
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';

            // Draw electrons orbiting in the background
            const time = Date.now() * 0.001;

            for (let i = 0; i < 5; i++) {
                const x = canvas.width / 2 + Math.cos(time + i) * (100 + i * 50);
                const y = canvas.height / 3 + Math.sin(time + i) * (100 + i * 30);

                ctx.beginPath();
                ctx.arc(x, y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.closePath();
            }

            // Draw atom nucleus
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 3, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.closePath();

            // Draw orbits
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 2;

            for (let i = 0; i < 3; i++) {
                ctx.beginPath();
                ctx.ellipse(canvas.width / 2, canvas.height / 3, 100 + i * 50, 80 + i * 30, 0, 0, Math.PI * 2);
                ctx.stroke();
                ctx.closePath();
            }
        }

        // Update game state
        function update() {
            if (game.gameOver || game.paused) return;

            // Apply gravity to player
            player.velY += game.gravity;
            player.y += player.velY;

            // Check if player falls off screen
            if (player.y > canvas.height) {
                loseLife();
                if (!game.gameOver) {
                    player.y = canvas.height - 150;
                    player.velY = 0;
                }
                return;
            }

            // Horizontal movement
            if (keys.left) {
                player.x -= player.speed;
            }
            if (keys.right) {
                player.x += player.speed;
            }

            // Keep player within screen bounds
            if (player.x < 0) {
                player.x = 0;
            } else if (player.x + player.width > canvas.width) {
                player.x = canvas.width - player.width;
            }

            // Handle jumping
            if (keys.up && player.grounded) {
                player.velY = -15;
                player.grounded = false;
            }

            // Platform collision detection
            player.grounded = false;

            for (let i = 0; i < game.platforms.length; i++) {
                const platform = game.platforms[i];

                // Check if player is above platform and falling
                if (player.y + player.height <= platform.y &&
                    player.y + player.height + player.velY >= platform.y &&
                    player.x + player.width > platform.x &&
                    player.x < platform.x + platform.width) {

                    player.grounded = true;
                    player.velY = 0;
                    player.y = platform.y - player.height;
                }
            }

            // Electron collection
            for (let i = 0; i < game.electrons.length; i++) {
                const electron = game.electrons[i];

                if (!electron.collected &&
                    player.x < electron.x + electron.radius &&
                    player.x + player.width > electron.x - electron.radius &&
                    player.y < electron.y + electron.radius &&
                    player.y + player.height > electron.y - electron.radius) {

                    electron.collected = true;

                    if (electron.type === 'normal') {
                        game.score += 10;
                        document.getElementById('score').textContent = game.score;
                    } else {
                        // Special electron - trigger question
                        showQuestion();
                    }
                }
            }

            // Check if all electrons are collected to create more platforms and electrons
            let allCollected = true;
            for (let i = 0; i < game.electrons.length; i++) {
                if (!game.electrons[i].collected) {
                    allCollected = false;
                    break;
                }
            }

            if (allCollected && game.electrons.length > 0) {
                // Move all platforms and player down
                const offset = canvas.height / 2;

                for (let i = 0; i < game.platforms.length; i++) {
                    game.platforms[i].y += offset;
                }

                player.y += offset;

                // Remove platforms that are below the screen
                game.platforms = game.platforms.filter(platform => platform.y < canvas.height);

                // Add new platforms and electrons
                const numNewPlatforms = 5;
                const minWidth = 100;
                const maxWidth = 200;
                const minGap = 60;
                const maxGap = 150;

                let lastPlatformY = game.platforms.length > 0 ?
                    Math.min(...game.platforms.map(p => p.y)) : canvas.height - 100;

                for (let i = 0; i < numNewPlatforms; i++) {
                    const width = Math.random() * (maxWidth - minWidth) + minWidth;
                    const x = Math.random() * (canvas.width - width);
                    const gap = Math.random() * (maxGap - minGap) + minGap;
                    lastPlatformY -= gap;

                    if (lastPlatformY > 0) {
                        game.platforms.push({
                            x: x,
                            y: lastPlatformY,
                            width: width,
                            height: 20,
                            color: '#3F51B5'
                        });

                        // Add electron on platform
                        if (Math.random() > 0.3) {
                            game.electrons.push({
                                x: x + width / 2,
                                y: lastPlatformY - 20,
                                radius: 10,
                                collected: false,
                                type: Math.random() > 0.3 ? 'normal' : 'special',
                                color: Math.random() > 0.3 ? '#FFD700' : '#FF4081'
                            });
                        }
                    }
                }
            }
        }

        // Show a random question
        function showQuestion() {
            game.paused = true;

            const questionIndex = Math.floor(Math.random() * game.questions.length);
            const question = game.questions[questionIndex];

            document.getElementById('question-text').textContent = question.question;

            const answerButtons = document.querySelectorAll('.answer-btn');

            for (let i = 0; i < answerButtons.length; i++) {
                answerButtons[i].textContent = question.answers[i];
                answerButtons[i].onclick = function () {
                    checkAnswer(i === question.correct);
                };
            }

            document.getElementById('question-container').style.display = 'block';
        }

        // Check if answer is correct
        function checkAnswer(correct) {
            document.getElementById('question-container').style.display = 'none';
            game.totalAnswers++;

            if (correct) {
                game.correctAnswers++;
                game.score += 50;
                document.getElementById('score').textContent = game.score;
            } else {
                loseLife();
            }

            game.paused = false;
        }

        // Lose a life
        function loseLife() {
            game.lives--;
            document.getElementById('lives').textContent = game.lives;

            if (game.lives <= 0) {
                endGame();
            }
        }

        // End the game
        function endGame() {
            game.gameOver = true;

            document.getElementById('final-score').textContent = game.score;

            // Calculate and display accuracy
            const accuracy = game.totalAnswers > 0 ?
                Math.round((game.correctAnswers / game.totalAnswers) * 100) : 0;

            document.getElementById('accuracy').textContent = accuracy;

            // Store accuracy in localStorage for future use
            localStorage.setItem('semiconductorGameAccuracy', accuracy);

            document.getElementById('game-over').style.display = 'block';
        }

        // Main game loop
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            drawBackground();
            drawPlatforms();
            drawElectrons();
            drawPlayer();

            if (!game.gameOver && !game.paused) {
                update();
            }

            requestAnimationFrame(gameLoop);
        }

        // Event listeners for desktop
        document.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowLeft') keys.left = true;
            if (e.key === 'ArrowRight') keys.right = true;
            if (e.key === 'ArrowUp' || e.key === ' ') keys.up = true;
            e.preventDefault();
        });

        document.addEventListener('keyup', function (e) {
            if (e.key === 'ArrowLeft') keys.left = false;
            if (e.key === 'ArrowRight') keys.right = false;
            if (e.key === 'ArrowUp' || e.key === ' ') keys.up = false;
            e.preventDefault();
        });

        // Event listeners for mobile
        document.getElementById('left-btn').addEventListener('touchstart', function (e) {
            keys.left = true;
            e.preventDefault();
        });

        document.getElementById('right-btn').addEventListener('touchstart', function (e) {
            keys.right = true;
            e.preventDefault();
        });

        document.getElementById('jump-btn').addEventListener('touchstart', function (e) {
            keys.up = true;
            e.preventDefault();
        });

        document.getElementById('left-btn').addEventListener('touchend', function (e) {
            keys.left = false;
            e.preventDefault();
        });

        document.getElementById('right-btn').addEventListener('touchend', function (e) {
            keys.right = false;
            e.preventDefault();
        });

        document.getElementById('jump-btn').addEventListener('touchend', function (e) {
            keys.up = false;
            e.preventDefault();
        });

        // Mouse controls for testing on desktop
        document.getElementById('left-btn').addEventListener('mousedown', function () {
            keys.left = true;
        });

        document.getElementById('right-btn').addEventListener('mousedown', function () {
            keys.right = true;
        });

        document.getElementById('jump-btn').addEventListener('mousedown', function () {
            keys.up = true;
        });

        document.getElementById('left-btn').addEventListener('mouseup', function () {
            keys.left = false;
        });

        document.getElementById('right-btn').addEventListener('mouseup', function () {
            keys.right = false;
        });

        document.getElementById('jump-btn').addEventListener('mouseup', function () {
            keys.up = false;
        });

        // Prevent touch events from scrolling the page
        document.addEventListener('touchmove', function (e) {
            e.preventDefault();
        }, { passive: false });

        // Play again button
        document.getElementById('play-again').addEventListener('click', function () {
            document.getElementById('game-over').style.display = 'none';
            initGame();
        });

        // Start button
        document.getElementById('start-btn').addEventListener('click', function () {
            document.getElementById('start-screen').style.display = 'none';
            initGame();
            gameLoop();
        });

        // Handle window resize
        window.addEventListener('resize', function () {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Initialize and start the game when window is loaded
        window.addEventListener('load', function () {
            // Game starts when start button is clicked
        });
    </script>
</body>

</html>